= CppTest Utility ðŸš€
:toc: macro
:icons: font
:source-highlighter: highlight.js

**CppTest** is a powerful command-line tool for competitive programming (CP).
It automates compilation, testing, test generation, and stress testing with a focus on clean workflow and isolation.

toc::[]

== ðŸ“¦ Installation

To install or update the utility, run this single command in your terminal:

[source,bash]
----
rm -rf /tmp/cpptest_inst && git clone --depth=1 https://github.com/MootSasa/CppTest.git /tmp/cpptest_inst && bash /tmp/cpptest_inst/install.sh && rm -rf /tmp/cpptest_inst
----

== ðŸ“‚ Project Structure

CppTest works best when you organize your problem folder like this:

[source,text]
----
TaskA/                      <-- Root folder of the problem
â”œâ”€â”€ main.cpp                <-- [REQUIRED] Your optimized solution
â”‚
â”œâ”€â”€ tests/                  <-- [OPTIONAL] Manual tests (downloaded from contest)
â”‚   â”œâ”€â”€ 1.in
â”‚   â”œâ”€â”€ 1.out               <-- Expected output (optional)
â”‚   â””â”€â”€ 2.in
â”‚
â”œâ”€â”€ gen.cpp                 <-- [OPTIONAL] Test Generator
â”œâ”€â”€ tests.cfg               <-- [OPTIONAL] Generator configuration
â”œâ”€â”€ gen_tests/              <-- [AUTO] Folder where CppTest saves generated tests
â”‚
â”œâ”€â”€ check.cpp               <-- [OPTIONAL] Custom Checker (for tasks with multiple answers)
â””â”€â”€ slow.cpp                <-- [OPTIONAL] Brute-force solution (for Stress Testing)
----

== ðŸš€ Usage Guide

=== 1. Basic Testing
Simply run the command in the problem folder. It compiles `main.cpp` and runs it against all found tests.

[source,bash]
----
cpptest
----

=== 2. Using Generator (`gen.cpp`)
If you create `gen.cpp`, the utility will:
1.  Compile it.
2.  Read `tests.cfg` (if present) or use defaults.
3.  Generate inputs into `gen_tests/`.
4.  Run `main.cpp` on them.

**Config format (`tests.cfg`):** `Count Arguments`
[source,text]
----
10  1 100    # Run ./gen 1 100 (10 times)
5   500 1000 # Run ./gen 500 1000 (5 times)
----

=== 3. Stress Testing (`-S`)
Used to find bugs by comparing your optimized solution (`main.cpp`) against a slow but correct one (`slow.cpp`).

**Requirements:** `main.cpp`, `slow.cpp`, `gen.cpp`.

[source,bash]
----
cpptest -S
----
*It runs an infinite loop generating random tests until `main` and `slow` outputs disagree.*

== ðŸš© Command Line Flags

[cols="1,4", options="header"]
|===
| Flag | Description

| **Test Selection** |
| `-a`, `--manual` | Run ONLY manual tests (from `tests/` and root).
| `-g`, `--generated` | Run ONLY generated tests (from `gen_tests/`).
| `filename.in` | Run ONLY specific file (e.g., `cpptest tests/1.in`).

| **Generation** |
| `-n`, `--no-gen` | **Skip Generation.** Use existing tests in `gen_tests/` without running `gen.cpp`.
| `-G`, `--gen-only` | **Generate & Exit.** Generate tests and stop. Do not run solution.
| `--no-gen-config` | Ignore `tests.cfg` and use defaults (100 tests).

| **Modes** |
| `-S`, `--stress` | **Stress Mode.** Brute-force comparison (`main` vs `slow`).
| `-i`, `--in-place` | Run directly in source directory (disable `/tmp` isolation).

| **Code Modifiers** |
| `-F`, `--fix` | **Auto-Fix.** Applies `clang-format` and `clang-tidy` fixes to `main.cpp` and **exits immediately**.
| `-R`, `--no-comments`| **Remove Comments.** Permanently removes `//` and `/* */` from `main.cpp` and **exits immediately**.

| **Advanced** |
| `-f`, `--fast` | **Fast Run.** Skip static analysis (Linter).
| `-K`, `--force-checker`| Force usage of `check.cpp`. Error if missing.
| `-k`, `--force-diff` | Force standard `diff` comparison (ignore checker).
| `-u`, `--update` | **Self-Update.** Update utility from GitHub.
|===

== âš™ï¸ Custom Checkers
For problems where the output is not unique (e.g., "Print any path"), standard comparison fails.
Create `check.cpp`. CppTest will automatically use it.

**Signature:**
[source,cpp]
----
int main(int argc, char* argv[]) {
    ifstream inf(argv[1]); // Input
    ifstream ouf(argv[2]); // Your Output
    ifstream ans(argv[3]); // Correct Output (optional)
    // ... logic ...
    if (correct) return 0;
    else return 1;
}
----

== ðŸ¤– AI Prompts
Copy this block to AI to generate helper files quickly.
**Click the copy icon on the right side of the block below.**

.%collapsible
====
[source,json]
----
{
  "role": "Expert Competitive Programming Assistant",
  "task": "Generate testing infrastructure files (gen.cpp, check.cpp, tests.cfg) for a custom C++ testing utility named 'CppTest'.",
  "input_data": {
    "problem_description": "[INSERT THE TASK CONDITION HERE]",
    "constraints": "[INSERT CONSTRAINTS HERE: N, M, Maximum Values, Input Format]"
  },
  "output_requirements": {
    "file_1": "gen.cpp",
    "file_1_rules": [
      "Must use 'std::mt19937' seeded with chrono.",
      "Must accept command line arguments (argv) to control generation parameters (e.g., N, M, RangeMin, RangeMax).",
      "Do NOT use hardcoded values; map argv[1], argv[2]... to problem constraints.",
      "Must print the test case to 'stdout' matching the problem input format.",
      "Ensure generated data strictly follows the constraints."
    ],
    "file_2": "check.cpp",
    "file_2_rules": [
      "Signature: int main(int argc, char* argv[])",
      "Arguments: argv[1] = input_file, argv[2] = user_output, argv[3] = expected_output (optional).",
      "Use 'std::ifstream' to read files.",
      "Logic: The checker MUST be 'smart'. It should solve the problem internally (using a reliable O(N^2) or O(N log N) algorithm) to calculate the correct answer, and then compare it with the user's output.",
      "Reason for smart checker: The testing utility might not provide an .out file, so the checker cannot rely solely on argv[3].",
      "Return code: 0 for OK, 1 for Wrong Answer (WA).",
      "Must check for correct format and extra junk data at the end of user output."
    ],
    "file_3": "tests.cfg",
    "file_3_rules": [
      "Format per line: 'Count Arg1 Arg2 Arg3...'",
      "Arg1, Arg2... correspond to argv[1], argv[2]... in gen.cpp.",
      "Create 5-7 groups of tests:",
      "  1. Small manual-like tests.",
      "  2. Corner cases (min N, max N, min values).",
      "  3. Random medium tests.",
      "  4. Max constraints tests (Stress).",
      "Ensure the total number of tests is around 50-100."
    ]
  },
  "output_format": "Provide exactly three code blocks. Do not add unnecessary conversational text."
} 
----
====

== ðŸ—‘ Uninstall
[source,bash]
----
uncpptest
----
